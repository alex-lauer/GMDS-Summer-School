<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Longitudinal Data Modeling - 5&nbsp; Sensitivity Analyses</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./s5_inferences_binary.html" rel="next">
<link href="./s3_missingness.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./s4_sensitivity_analyses.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sensitivity Analyses</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Longitudinal Data Modeling</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s1_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Longitudinal Data Exploration and Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s2_inference_continuous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Inference from Longitudinal Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s3_missingness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Missing Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s4_sensitivity_analyses.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sensitivity Analyses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./s5_inferences_binary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Inferences from binary longitudinal data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#purpose-of-sensitivity-analyses" id="toc-purpose-of-sensitivity-analyses" class="nav-link active" data-scroll-target="#purpose-of-sensitivity-analyses"><span class="header-section-number">5.1</span> Purpose of sensitivity analyses</a></li>
  <li><a href="#mmrm-vs.-mi" id="toc-mmrm-vs.-mi" class="nav-link" data-scroll-target="#mmrm-vs.-mi"><span class="header-section-number">5.2</span> MMRM vs.&nbsp;MI</a></li>
  <li><a href="#missing-covariates-baseline-data-only" id="toc-missing-covariates-baseline-data-only" class="nav-link" data-scroll-target="#missing-covariates-baseline-data-only"><span class="header-section-number">5.3</span> Missing covariates (baseline data) only</a></li>
  <li><a href="#sensitivity-analyses---simple-approaches" id="toc-sensitivity-analyses---simple-approaches" class="nav-link" data-scroll-target="#sensitivity-analyses---simple-approaches"><span class="header-section-number">5.4</span> Sensitivity analyses - Simple approaches</a></li>
  <li><a href="#sensitivity-analyses---handling-nonignorable-missingness-mnar" id="toc-sensitivity-analyses---handling-nonignorable-missingness-mnar" class="nav-link" data-scroll-target="#sensitivity-analyses---handling-nonignorable-missingness-mnar"><span class="header-section-number">5.5</span> Sensitivity analyses - Handling nonignorable missingness (MNAR)</a>
  <ul class="collapse">
  <li><a href="#reference-based-multiple-imputation" id="toc-reference-based-multiple-imputation" class="nav-link" data-scroll-target="#reference-based-multiple-imputation"><span class="header-section-number">5.5.1</span> Reference-based multiple imputation</a></li>
  <li><a href="#delta-based-multiple-imputation" id="toc-delta-based-multiple-imputation" class="nav-link" data-scroll-target="#delta-based-multiple-imputation"><span class="header-section-number">5.5.2</span> Delta-based multiple imputation</a></li>
  </ul></li>
  <li><a href="#practical-part" id="toc-practical-part" class="nav-link" data-scroll-target="#practical-part"><span class="header-section-number">5.6</span> Practical part</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sensitivity Analyses</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Purpose: talk about sensitivity analyses with respect to missing data</p>
<ul>
<li>MMRM is an appropriate choice for the primary analysis in many longitudinal clinical trials under the missing at random (MAR) assumption.</li>
<li>MMRM can handle missing values. BUT: need of baseline and at least one post-baseline value.</li>
<li>No imputation for individual missing values but missing data is implicitly imputed.</li>
<li>Exploit the correlation between outcomes within subjects.</li>
<li>MAR: future outcomes for subjects who discontinued are assumed be similar to the future outcomes of subjects who continued if they had the same values of past (observed) outcomes, covariates,…</li>
</ul>
<section id="purpose-of-sensitivity-analyses" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="purpose-of-sensitivity-analyses"><span class="header-section-number">5.1</span> Purpose of sensitivity analyses</h2>
<ul>
<li>Consider sensivitiy analyses to check model assumptions e.g.&nbsp;assumption of MAR.</li>
<li>Comparing results from sensitivity analyses: how much inference rely on the assumptions.</li>
<li>Here, inference with regard to the treatment effect. Thus, investigate how treatment effects vary depending on assumptions (about missing data).</li>
<li>Uncertainty from incompleteness cannot be objectively evaluated from observed data so there is a need for missing data sensitivity analyses.</li>
</ul>
</section>
<section id="mmrm-vs.-mi" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="mmrm-vs.-mi"><span class="header-section-number">5.2</span> MMRM vs.&nbsp;MI</h2>
<ul>
<li>Flexibility in modeling treatment effects over time and the within-patient error correlation structure makes MMRM a widely useful analysis.</li>
<li>MMRM, MI: two major approaches to missing data with good statistical properties. Both rely on MAR assumption (for MI: standard implementation).</li>
<li>MMRM: missing values implicitly imputed, MI: missing values explicitly imputed.</li>
<li>MMRM vs.&nbsp;MI: approximately equivalent provided the variables used in the imputation model are the same as those included in the analysis model (level of equivalence will depend on the number of imputations)</li>
<li>MI: imputation model with at least those variables from the primary model, additional auxiliary variables can be used in the imputation model to improve the accuracy of the missing data prediction.</li>
<li>Handling missing not at random (MNAR) possible for MI (e.g.&nbsp;reference-based imputation) but not within MMRM.</li>
<li>MMRM does not work if missing baseline values are present. Missing baseline values can be imputed first. Additionally, at least one post-baseline value has to be observed. Alternative: LDA where baseline is part of the response vector.</li>
</ul>
<p>Note that, when implemented in similar manners, MI and MMRM have similar assumptions and yield similar results. Thus, MI implemented similarly to MMRM is not a sensitivity analysis!</p>
</section>
<section id="missing-covariates-baseline-data-only" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="missing-covariates-baseline-data-only"><span class="header-section-number">5.3</span> Missing covariates (baseline data) only</h2>
<ul>
<li>Missing baseline value of the outcome (and other covariates) is a common situation</li>
<li>MMRM not efficient or potential biased estimates as subjects with missing covariates are excluded from the analysis</li>
<li><span class="citation" data-cites="kayembe2022">(<a href="references.html#ref-kayembe2022" role="doc-biblioref">Kayembe and Breukelen 2022</a>)</span> compared different methods e.g.&nbsp;unadjusted analysis, complete case, mean imputation, MI: mean imputation seems to be appropriate as long as the covariates are measured before randomization (produces unbiased treatment effect estimates with good coverage, easy to implement)</li>
</ul>
<p>Now, we consider the situation as in our data sets: no intermittent missing values, baseline observed, drop-outs = monotone missing pattern</p>
</section>
<section id="sensitivity-analyses---simple-approaches" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sensitivity-analyses---simple-approaches"><span class="header-section-number">5.4</span> Sensitivity analyses - Simple approaches</h2>
<p>In general, not recommended for use. Methods are of historic interest and provide a useful starting point. - Last observation carried forward (LOCF): used in the past, justified as it was thought that it provides conservative estimates. - Complete case CC (observed case/completers analysis): creates selection bias, may cause overestimation of within group effects particularly at the last scheduled visit.</p>
<p>We apply these two methods here as well to compare results.</p>
<p>Application: - LOCF: all patients, consider data set with baseline value of the outcome and last observation of the outcome, apply ANCOVA - CC: only patients with visit week 8 observed</p>
</section>
<section id="sensitivity-analyses---handling-nonignorable-missingness-mnar" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="sensitivity-analyses---handling-nonignorable-missingness-mnar"><span class="header-section-number">5.5</span> Sensitivity analyses - Handling nonignorable missingness (MNAR)</h2>
<ul>
<li>Assumption of MAR is often reasonable, but possibility of data missing not at random (MNAR) is difficult to rule out.</li>
<li>Thus, analysis under MNAR needed.</li>
<li>Analysis under MNAR: these methods are heavily assumption driven and the assumptions are not testable as we do not have the missing data.</li>
<li>Consider a sensitivity analysis framework allowing assessment of robustness of results to the various assumptions.</li>
<li>MNAR methods: different possibilities e.g.&nbsp;class of pattern-mixture models. The pattern-mixture model allows missing outcomes to be imputed under a chosen scenario and in this way can be used to complete the data set and apply the primary analysis to this completed data set.</li>
<li>MI can be used to explore departures from MAR (for analysis under a MNAR assumption). This is referred to as controlled MI and includes delta-based MI and reference-based MI (belong to the class of pattern mixture models). Data is imputed under an alternative MNAR distribution that reflects a relevant scenario for the unobserved data. The imputed data sets are then analysed as with standard MI.</li>
</ul>
<section id="reference-based-multiple-imputation" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="reference-based-multiple-imputation"><span class="header-section-number">5.5.1</span> Reference-based multiple imputation</h3>
<ul>
<li>Has recieved increasing attention in clinical trials as it provides an attractive approach for a sensitivity analysis because missing data assumptions are framed in an intuitive way. The departure from MAR is captured in a qualitative way, making the formulation of the problem intuitive.</li>
<li>For example, a plausible MNAR mechanism in a placebo‐controlled trial is to assume that subjects in the experimental arm who dropped out stop taking their treatment and have similar outcomes to those in the placebo arm.</li>
<li>Remember: MI under MAR assumes that the outcome distribution of patients with missing data is the same as the outcome distribution of patients with complete data, conditional on relevant covariates. However, if most patients withdraw from the study after treatment discontinuation, then this is not plausible, as patients who withdraw from the study treatment are expected to have a worse otucome than patinets who stay on study treatment. Thus, addressing missing data under a MAR assumption estimates a hypothetical estimand and not a treatment policy estimand.</li>
<li>Different options to handle missing outcome data for reference-based imputation were described <span class="citation" data-cites="carpenter2013">(<a href="references.html#ref-carpenter2013" role="doc-biblioref">Carpenter and Kenward 2013</a>)</span>: e.g.&nbsp;jump to reference (J2R), copy reference (CR), copy increments in reference (CIR)</li>
</ul>
<p>Jump to reference J2R assumes that after treatment discontinuation, the patient’s mean outcome distribution is that of a reference group, usually the control group. This is a very extreme assumption, as this implies that any efficacy of the drug vanishes immediately after discontinuation - may be plausible for symptomatic treatments.</p>
<p>Copy reference CR assumes that the patient’s outcome distribution both before and after treatment discontinuation is the same as the distribution of the reference group. This has a milder effect than J2R: If a treatment-group patient has an outcome that is better than the reference group mean before treatment discontinuation, their imputed values after treatment discontinuation will also be better than the reference group mean.</p>
<p>Copy increments in reference CIR assumes that after treatment discontinuation, the increments are the same as those from the reference group. This is much milder than J2R and CR and implies that benefit gained from the treatment before discontinuation is not lost.</p>
<p>The conventional approach to analyse data using these reference based approaches is MI, following the same steps as MI under MAR.</p>
<p>Software, R: the rbmi package supports reference-based strategies <span class="citation" data-cites="gowerpage2022">(<a href="references.html#ref-gowerpage2022" role="doc-biblioref">Gower-Page and Wolbers 2022</a>)</span></p>
</section>
<section id="delta-based-multiple-imputation" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="delta-based-multiple-imputation"><span class="header-section-number">5.5.2</span> Delta-based multiple imputation</h3>
<ul>
<li>Impute data assuming all unobserved subjects having a poorer or better response than those observed, by adding or subtracting a delta parameter <span class="math inline">\(\delta\)</span> to the expected value of the e.g.&nbsp;MAR imputed values.</li>
<li>Delta can be implemented in all treatment groups, or in only one group, or may vary by treatment group or an alternative specified factor.</li>
<li>Choice of values for the sensitivity parameter <span class="math inline">\(\delta\)</span>: e.g.&nbsp;selection by content experts.</li>
<li>Steps: 1. missing values are imputed using standard MI procedure e.g.&nbsp;under MAR (but can also be under MNAR e.g.&nbsp;combinded with copy reference approach), 2. imputed values are shifted by adding some fixed value <span class="math inline">\(\delta\)</span> to reflect the MNAR mechanism, 3. analysis with standard statistical methods including Rubin’s rule to combine results</li>
</ul>
</section>
</section>
<section id="practical-part" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="practical-part"><span class="header-section-number">5.6</span> Practical part</h2>
<ul>
<li>Take the <em>all2</em> (<em>high2</em>) data set</li>
<li>Look at the complete case analysis.</li>
<li>Apply additionally LOCF and compare results.</li>
<li>Try MNAR method reference-based MI and/or delta-based MI. Compare with the other results.</li>
</ul>
<p>You can start and familiarise yourself with the <code>rbmi()</code> package using the command</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rbmi)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>?rbmi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-carpenter2013" class="csl-entry" role="listitem">
Carpenter, Roger, J. R., and M. G. Kenward. 2013. <span>“Analysis of Longitudinal Trials with Protocol Deviation: A Framework for Relevant, Accessible Assumptions, and Inference via Multiple Imputation.”</span> <em>Journal of Biopharmaceutical Statistics</em>, October. <a href="https://doi.org/10.1080/10543406.2013.834911">https://doi.org/10.1080/10543406.2013.834911</a>.
</div>
<div id="ref-gowerpage2022" class="csl-entry" role="listitem">
Gower-Page, Noci, C., and M. Wolbers. 2022. <span>“Rbmi: A r Package for Standard and Reference-Based Multiple Imputation Methods.”</span> <em>Journal of Open Source Software</em>, June. <a href="https://doi.org/10.21105/joss.04251">https://doi.org/10.21105/joss.04251</a>.
</div>
<div id="ref-kayembe2022" class="csl-entry" role="listitem">
Kayembe, Jolani, M. T., and G. J. P. van Breukelen. 2022. <span>“Imputation of Missing Covariates in Randomized Controlled Trials with Continuous Outcomes: Simple, Unbiased and Efficient Methods.”</span> <em>Journal of Biopharmaceutical Statistics</em>, September. <a href="https://doi.org/10.1080/10543406.2021.2011898">https://doi.org/10.1080/10543406.2021.2011898</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./s3_missingness.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Missing Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./s5_inferences_binary.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Inferences from binary longitudinal data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>